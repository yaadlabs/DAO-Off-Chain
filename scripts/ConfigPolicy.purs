module Scripts.ConfigPolicy
  ( unappliedConfigPolicy
  ) where

import Contract.Prelude

import Contract.Monad (Contract, liftContractE)
import Contract.PlutusData (toData)
import Contract.Prim.ByteArray (ByteArray)
import Contract.Scripts
  ( MintingPolicy(PlutusMintingPolicy)
  , PlutusScript
  , applyArgs
  )
import Ctl.Internal.Types.Scripts (plutusV2Script)
import ScriptArguments.Types (NftConfig)
import Scripts.Utils (scriptStringToJson, toJsonBytes')

unappliedConfigPolicy :: NftConfig -> Contract MintingPolicy
unappliedConfigPolicy configParams = do
  appliedConfigPolicy <- liftContractE $ configMintingPolicyScript `applyArgs`
    [ toData configParams ]
  pure $ PlutusMintingPolicy appliedConfigPolicy

configMintingPolicyScript :: PlutusScript
configMintingPolicyScript = plutusV2Script configPolicyByteArray

configPolicyByteArray :: ByteArray
configPolicyByteArray = toJsonBytes' $ scriptStringToJson configPolicyString

-- Generate policy string
configPolicyString :: String
configPolicyString =
  "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"
